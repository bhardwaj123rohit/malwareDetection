package malwaredetectionandroid;

public class kernel {

public static int  MaxHashFreq;//M
public static int MaxHashVal;//N


double phi_d[];

public kernel(int DefaultHist[],int N,int M)
{
	
	MaxHashFreq=M;
	MaxHashVal=N;
	
	phi_d=new double[MaxHashFreq*MaxHashVal];
	
	for(int i=0;i<N;i++)
	{
		for(int j=0;j<DefaultHist[i];j++)
		{
			phi_d[i*M+j]=1.0;
			
			
		}
		
	}
	
} //end of constructor

	

public double[] similarity(int Hist[]) {
	double phi[]=new double[MaxHashFreq*MaxHashVal];
	double Sim[]=new double[MaxHashFreq*MaxHashVal];
	
	
	for(int i=0;i<MaxHashVal;i++)
	{
		for(int j=0;j<Hist[i];j++)
		{
			phi[i*MaxHashFreq+j]=1.0;
			
			
		}
		
	}
	
	
	for(int i=0;i<MaxHashVal;i++)
	{
		for(int j=0;j<MaxHashFreq;j++)
		{
			if(phi[i*MaxHashFreq+j]==1&&phi_d[i*MaxHashFreq+j]==1)
			Sim[i*MaxHashFreq+j]=1.0;
			else
			Sim[i*MaxHashFreq+j]=0.0;
			
			
		}
		
	}
	
	
	
	return Sim;
	
}

	
	
}
